---
layout:            post
title:             "18/01/02- machine learning  - 추천 엔진 이해"
entitle:          "18/01/02- machine learning  - 추천 엔진 이해"
category:          project
author:            myohyun
tags:              machine learning
---

추천 시스템의 다양한 하위 유형들

이웃기반 추천 엔진

- 사용자 기반 협업 필터링
- 아이템 기반 협업 필터링

개인화 추천 엔진

- 콘텐츠 기반추천 엔진
- 상황인식 추천 엔진

모델 기반 추천 엔진

- ML기반 추천 엔진
- 분류: svm/kNN
- 행렬인수분해
- 특이값 분해
- 교대 최소 제곱
- 하이브리드 추천 엔진

추천엔진 1세대: 협업 필터링 or 이웃 기반 방식 추천 시스템

- 장점: 매우 성능이 좋다
- 단점: 
  - 콜드 스타트 문제와 같은 제약 사항들이 있다. 즉, 등급 정보가 없는 새로운 사용자에게 제품을 추천하거나 등급이 없는 새로운 제품을 사용자에게 추천하는 데는 실패함
  - 데이터가 매우 부족한 시나리오를 처리하지 못해서 제품에 대한 사용자 등급이 훨씬 적다

이러한 한계들을 극복하기 위해 새로운 접근법을 개발. 데이터 희소성이 높은 매무 많은 사용자 등급을 처리하기 위해 행렬 인수 분해와 특이값 분해 방법과 같은 수학적 접근법이 사용됐다.

콜드스타트 문제를 해결하기 위해 **콘텐츠 기반 추천 시스템** 과 같은 새로운 접근법이 개발됨.  이러한 추천 시스템들은 개인화 추천 시스템과 같은 더 많은 기회를 열어 각각의 사용자에게 개인 차원에서 제품을 추천할 수 있게 했다.

(개인화추천시스템 : 등급 정보 대신 사용자의 개인적인 선호도와 제품 특징들을 고려.)

(콘텐츠기반 추천시스템: )

- 처음에는 콘테츠 기반 추천 시스템에서 유사도 계산이 사용됐지만, 기술과 인프라가 발전함에 따라 머신러닝 모델과 같은 좀 더 향상된 방법이 휴리스틱 방법을 대체했다. 이러한 새로운 머신 모델은 추천의 정확도를 향상시켰다.
- 콘텐츠 기반 추천 시스템은 협업 필터링의 많은 단점을 해결했지만. 협업 필터링에서는 가능한 우연성, 즉 사용자의 선호도범위를 벗어난 새로운 아이템을 추천할 수 없는 고유한 단점을 갖고 있다. 이러한 문제를 해결하기 위해 연구원들은 다양한 추천 모델을 조합해서 **하이브리드 추천 모델** 을 내놓았는데. 이 모델은 각각 개별모델보다 훨씬 더 견고한 성능을 지녔다.

개인화 추천 엔진을 독자적으로 구현하는 데 성공함으로써 사람들은 개인화를 위치, 시간, 그룹 등의 추가와 같은 상황이라고 하는 다른 차원으로 확장시키기 시작했고, 각 상황에 따라 추천 사항을 변경

빅데이터를 처리할 수 있는 환경 조성됨

머신러닝 접근법 -> 신경망 딥러닝 방식으로 이동중



## 최근적 이웃 기반 추천 엔진

`협업필터링 추천시스템`, `유사도 기반 추천 시스템`, `휴리스틱 기반 방식` 

- 사용자의 커뮤니티나 이웃 사용자들의 선호도 또는 좋아하는 것을 고려. 선호도 또는 취향이 사용자 풀에서 공동으로 고려되므로, `협업필터링 추천시스템`이라고도 함
- 사용자 등급이 주어지면, 과거 활성 사용자와 유사한 선호도를 지닌 모든 사용자들을 찾은 후 활성 사용자가 아직 평가하지 않았으나 이웃들은 평가한 모든 미지의 제품에 대해 등급을 예측
- 유사도 계산 포함 -> `유사도 기반 추천 시스템`이라고도 함 
- 이러한 유형의 시스템에서는 주요 관계자는 `사용자`, `제품`, 그리고 `등급`/`순위`/`제품 선호도` 와 같은 사용자의 선호도 정보
- (예시: 아마존 이 아템을 구매한 사람들이 역시 또 구매한 것들)
- 이러한 휴리스틱 기반 방식은 다음 내용을 전제로 한다
  - 과거에 유사한 선호도를 가진 사람은 앞으로도 유사한 선호도를 갖는다
  - 사람의 선호도는 미래에도 확고하며 일관성을 유지할 것이다
- 협업필터링시스템: 이러한 이웃 기반 방식은 좋아요/싫어요, 조회 여부와 같은 제품에 대한 사용자의 상호작용 데이터만 있을 경우에 사용된다.제품의 특징이나 제품에 대한 사용자의 개인적인 선호도는 고려하지 않는다.
  - 사용자 기반 협업필터링
  - 아이템 기반 협업 필터링

## 사용자 기반 협업 필터링

사용자간의 유사도를 계산하여 취향이 비숫한 무리들을 찾아낸다.

유사도를 계산하기 위해 사용자들이 제공한 등급을 기반으로 계산한다. 

가장 흔히 사용되는 방법: 유클리드 거리,  피어슨 상관계수

사용자 기반 협업 필터링 단점: 

- 이 시스템은 사용자 등급들이 매우 부족한 셩우 성능 저하가 발생. 사용자들이 광범위한 카탈로그에서 일부 아이템만 평가하는 실게계에서는 매우 흔한 경우
- 데이터 규모가 매우 큰 경우 모든 사용자에 대한 유사도 값을 구하기 위한 계산 비용이 매우 크다.
- 사용자 프로필 또는 사용자 입력이 빠르게 변할 경우 유사도 값을 다시 계산해야 하며, 이로 인해 계산 비용이 높아진다.

##아이템 기반 협업필터링 

아이템기반 추천 엔진은 사용자 간의 유사도를 계산하는 대신 아이템 또는 제품 간의 유사도를 계산해 계산 비용을 줄임으로써 이러한 단점들을 해결한다. **아이템 카탈로그는 빠르게 변화하지 않기 때문에다시 계산할 일이 빈번하게 발생하지 않는다.**

아이템기반 협업 방식

- 아이템 간의 유사도를 계산
- 다른 유사한 아이템에 대해 주어진 기존 등급을 이용해서 활성 사용자가 평가하지 않는 아이템에 대한 등급을 예측

유사도 측정법: 코사인 유사도. 코사인 유사도는 벡터 공간에서 두 개의 n차원 벡터 간의 각도를 이용해서 유사도를 계산한다. 코사인 유사도는 다음 식을 이용해서 구한다.

$$ sim(\vec{a}, \vec{b}) = \frac{\vec{a} \cdot \vec{b}}{|\vec{a}|*|\vec{b}|}$$

추천 시스템에 코사인 유사로르 적용할 때, 아이템 열을 n차원 벡터로 여기고 두 앙템 간의 유사도를 두 벡터 사이의 각도로 여긴다. 각도 크기가 작을 수록 아이템은 유사.

(예시에서 아이템의 유사도를 평가하는 특징은 어떻게 뽑은건지?)

장점: 

- 구현하기 쉽다.
- 추천 생성 시에 제품의콘텐츠 정보 또는 사용자 프로필 정보는 필요하지 않다
- 사용자에게 깜짝 놀랄 만한 새로운 아이템을 추천한다

단점:

- 유사도 계산을 위해 모든 사용자, 제품, 그리고 등급 정보가 메모리에 로드되기 때문에 계산 비용이 높다
- 사용자에 대한 정보가 전혀 없는 경우에는 적합하지 않다. 이러한 문제점을 콜드 스타트 문제라고 한다.
- 데이터가 거의 없는 경우 성능이 저하된다.
- 사용자 또는 제품에 대한 콘텐츠 정보가 없기 때문에 등급 정보만으로는 정확한 추천을 생성할 수 있다

## 콘텐츠 기반 추천 시스템

추천을 생성하는데 개인화 수준을 목표로 하고 개개인의 선호도와 제품의 콘텐츠를 고려하는 추천 시스템은 콘텐츠 기반 추천 시스템이라고 한다.

콘텐츠 기반 추천 시스템 구축은 다음과 같이 세 가지 주요 단계로 이뤄진다.

1. 제춤에 대한 콘텐츠 정보를 생성한다.
2. 사용자 프로필과 제품 특직에 관련된 선호도를 생성한다
3. 추천을 생성하고 사용자가 좋아할 만한 아이템 리스트를 예측한다.

### 아이템 프로필 생성  

제품을 나타내는 특징을 추출

일반적으로 제품의 콘텐츠는 벡터 공간 모델에서 제품 이름과 특징이 행과 열로 표시된다. 

보통 제품의 콘텐츠는 구조화된 데이터 또는 비구조화된 데이터임. 구조화된 데이터는 데이터베이스로부터 얻는다. 비구조화된 특징들은 웹사이트와 관련된 후기, 태그, 또는 텍스트 속성을 포함한다. 아이템 프로필 생성 단계에서 관련 특징과 제품에 관련된 상대적 중요도 점수를 추출해야 한다. 이를 계산하는 데 단어빈도-역문서 빈도(tf-idf, tern frequency-inverse document frequency)를 사용한다. 아이템특징을 벡터 형태로 나타내기 때문에 tf-idf를 사용할 수 있는데, 이에 대한 자세한 내용은 4장에

### 사용자프로필 생성 

일반적으로 사용자 데이터를 얻는 방법:

1. 사용자에게 제품 특징과 관련해 사용자의 선호도를 명시적으로 묻고 저장한다
2. 브라우저 기록, 등급 기록, 구매 기록과 같이 제품에 대한 사용자 상호작용 데이터를 **암묵적으로** 얻어서 제품 특징에 대한 사용자 선호도를 구축

4,5장에서 명시적 및 암묵적 사용자 활동 예제를 사용해 추천엔진을 구축함

콘텐츠 기반 추천 시스템을 구축하기 위해 지금까지 수행했던 저근법은 유사도 계산을 기반으로 한다. 사용자가 좋아할 가능성이 가장 높은 제품을 예측하기 위해 분류와 같은 지도 학습 유형 머신 러닝 접근법을 적용할 수 있다

장점: 

- 콘텐츠 기반 추천 시스템은 개인화 수준을 목표로 한다
- 협업 필터링처럼 사용자 커뮤니티를 이용하기 보다는 사용자 선호도만 이용해서 추천 생성을 한다.
- 이러한 접근법은 추천 사항을 처리 또는 생성하기 위해 추천 모델이 모든 데이터를 로드할 필요가 없으므로 실시간 적용 가능하다
- 등급 정보만 처리하는 것이 아니라 제품의 콘텐츠를 처리하기 때문에 협업 방식 대비 정확도가 높다.
- 콜드스타트 문제를 쉽게 해결할 수 있다

단점:

- 시스템이 더 개인화됨에 따라 더 많은 사용자 정보가 시스템으로 유입되면 오직 사용자의 선호도에만 집중된 추천사항을 생성
- 그에 따라 사용자 선호도와 관련 없는새로운 제품은 사용자에게 소개하지 않는다
- 사용자는 자신의 주변에서 일어나느 일이나 최신 트렌드를 파악할 수 없게 된다

## 상황 인식 추천 시스템

개인화 추천 시스템은 개별 사용자 수준을 모교로 하고 사용자의 개인적인 선호도를 기반으로 추천을 생성하지만, 시스템을 개선해야 하는 부분이 있다. 예를 들면, 동일한 사람이 어떤 장소에 있는지에 따라 요구 사항이 달라질 수 있다. 마찬가지로, 동일한 사람이 시간에 따라 다른 요구 사항을 가진다. 위치, 시간, 기분, 환경 등등을 고려해 사용자의 상황을 정의하고 개인화된 추천사항을 제안하는 이러한 유형의 추천 시스템을 상황 인식 추천 시스템이라고 한다.

상황인식 시스템은 어떻게 설계되는가? 지금의 추천은 2차원 문제, 선호도와 아이템+상황(새로운 차원추가) =3차원문제로 만든다.

1. 사용자의 기호에 따라, 즉 콘텐츠 추천 기반으로 각 사용자에 대한 제품 추천 리스트를 생성
2. 현재 상황에 한정된 추천 사항들을 필터링

가장 흔히 사용되는 접근법: 먼저 걸러내고 개인화추천인가, 개인화추천 후에 걸러내는가 문제

- 사후 필터링 방식
- 사전 필터링 방식

장점: 

- 상황 인식 시스템은 사용자의 행동과 끊임없이 동기화하며 현재 상황에 맞는 추천을 생성하기 때문에 개인화 콘텐츠 기반 추천 시스템보다 훨씬 앞선 시스템이다
- 이러한 시스템은 좀 더 많은 실시간 특성을 가진다

단점:

- 다른 개인화 추천 시스템과 마나가지로 이러한 유형의 추천 시스템에